<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BrainBoard - Home</title>
  <link rel="stylesheet" href="interface.css">
  <script>
  const auth = localStorage.getItem('isAuthenticated');

  if (auth === 'false' || auth === null) {
      window.location.href = 'login.html';
  }
  </script>
  <style>
    /* Edit Profile Modal Styles */
    .edit-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
    }

    .edit-modal-content {
      background-color: white;
      border-radius: 12px;
      width: 90%;
      max-width: 450px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .edit-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      border-bottom: 1px solid #e0e0e0;
    }

    .edit-modal-header h2 {
      margin: 0;
      font-size: 20px;
      color: #333;
    }

    .edit-close-btn {
      font-size: 28px;
      color: #999;
      cursor: pointer;
      line-height: 1;
    }

    .edit-close-btn:hover {
      color: #333;
    }

    .edit-modal-body {
      padding: 24px;
    }

    .edit-form-group {
      margin-bottom: 20px;
    }

    .edit-form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #333;
      font-size: 14px;
    }

    .edit-form-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      box-sizing: border-box;
    }

    .edit-form-input:focus {
      outline: none;
      border-color: #4CAF50;
    }

    .edit-modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      padding: 20px 24px;
      border-top: 1px solid #e0e0e0;
    }

    .edit-btn-cancel, .edit-btn-save {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
    }

    .edit-btn-cancel {
      background-color: #f5f5f5;
      color: #666;
    }

    .edit-btn-cancel:hover {
      background-color: #e0e0e0;
    }

    .edit-btn-save {
      background-color: #4CAF50;
      color: white;
    }

    .edit-btn-save:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="logo-section">
        <div class="logo">BB</div>
        <div class="brand-name">BrainBoard</div>
      </div>
      <div class="search-bar">
        <input type="text" class="search-input" placeholder="Search courses, students, discussions..." id="searchInput">
        <div class="search-results" id="searchResults"></div>
      </div>
      <div class="user-menu">
        <div class="user-avatar" id="userAvatar" onclick="toggleProfile()">D</div>
        <div class="profile-dropdown" id="profileDropdown">
          <div class="profile-header">
            <div class="profile-avatar-large" id="profileAvatarLarge">D</div>
            <div class="profile-details">
              <h3 id="profileName">John Doe</h3>
              <p id="profileEmail">john.doe@example.com</p>
            </div>
          </div>
          <div class="profile-stats">
            <div class="stat-item">
              <span class="stat-number">42</span>
              <span class="stat-label">Posts</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">156</span>
              <span class="stat-label">Likes</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">23</span>
              <span class="stat-label">Following</span>
            </div>
          </div>
          <div class="profile-actions">
            <button class="profile-action-btn" onclick="editProfile()">‚úèÔ∏è Edit Profile</button>
            <button class="profile-action-btn" onclick="logout()" style="color: #ff6b6b;">üö™ Log Out</button>
          </div>
        </div>
        <button type="button" href="login.html" class="logout-btn" onclick="logout()">Log Out</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Feed Filter -->
    <div class="feed-filter">
      <div class="filter-buttons">
        <button class="filter-btn active" onclick="filterPosts('all', event)">All Posts</button>
        <button class="filter-btn" onclick="filterPosts('discussions', event)">Discussions</button>
        <button class="filter-btn" onclick="filterPosts('questions', event)">Questions</button>
        <button class="filter-btn" onclick="filterPosts('tips', event)">Study Tips</button>
      </div>
      <select class="sort-dropdown" onchange="sortPosts(this.value)">
        <option value="recent">Most Recent</option>
        <option value="popular">Most Popular</option>
        <option value="commented">Most Commented</option>
      </select>
    </div>

    <!-- Post Composer -->
    <div class="post-composer">
      <div class="composer-header">
        <div class="composer-avatar">D</div>
        <textarea class="composer-input" placeholder="Share your thoughts, ask questions, or post study tips..."></textarea>
      </div>
      <div class="composer-actions">
        <div class="media-buttons">
          <button class="media-btn" onclick="uploadMedia('photo')">üì∑ Photo</button>
          <button class="media-btn" onclick="uploadMedia('video')">üìπ Video</button>
          <button class="media-btn" onclick="uploadMedia('document')">üìÑ Document</button>
          <button class="media-btn" onclick="toggleQuestionMode()">üí° Question</button>
        </div>
        <button class="post-btn" onclick="createPost()">Post</button>
      </div>
    </div>

    <!-- Hidden file inputs -->
    <input type="file" id="photoInput" accept="image/*" class="hidden" onchange="handleFileUpload(this, 'photo')">
    <input type="file" id="videoInput" accept="video/*" class="hidden" onchange="handleFileUpload(this, 'video')">
    <input type="file" id="documentInput" accept=".pdf,.doc,.docx,.txt,.ppt,.pptx" class="hidden" onchange="handleFileUpload(this, 'document')">

    <!-- Feed -->
    <div class="feed" id="feedContainer">
      <!-- Sample posts will be generated here -->
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <button class="quick-action-btn" onclick="scrollToTop()" title="Scroll to Top">‚Üë</button>
    <button class="quick-action-btn" onclick="focusComposer()" title="New Post">‚úèÔ∏è</button>
  </div>

  <!-- Edit Profile Modal -->
  <div class="edit-modal" id="editProfileModal">
    <div class="edit-modal-content">
      <div class="edit-modal-header">
        <h2>Edit Profile</h2>
        <span class="edit-close-btn" onclick="closeEditModal()">&times;</span>
      </div>
      <div class="edit-modal-body">
        <div class="edit-form-group">
          <label for="editNameInput">Name</label>
          <input type="text" id="editNameInput" class="edit-form-input" placeholder="Enter your name">
        </div>
        <div class="edit-form-group">
          <label for="editEmailInput">Email</label>
          <input type="email" id="editEmailInput" class="edit-form-input" placeholder="Enter your email">
        </div>
        <div class="edit-form-group">
          <label for="editAvatarInput">Avatar Initial</label>
          <input type="text" id="editAvatarInput" class="edit-form-input" maxlength="1" placeholder="Enter one letter">
        </div>
      </div>
      <div class="edit-modal-footer">
        <button class="edit-btn-cancel" onclick="closeEditModal()">Cancel</button>
        <button class="edit-btn-save" onclick="saveProfileChanges()">Save Changes</button>
      </div>
    </div>
  </div>

  <script src="interface.js"></script>
  <script>
    // Edit Profile Functions
    function editProfile() {
      const modal = document.getElementById('editProfileModal');
      const name = localStorage.getItem('userName') || 'John Doe';
      const email = localStorage.getItem('userEmail') || 'john.doe@example.com';
      const avatar = localStorage.getItem('userAvatar') || 'D';
      
      document.getElementById('editNameInput').value = name;
      document.getElementById('editEmailInput').value = email;
      document.getElementById('editAvatarInput').value = avatar;
      
      modal.style.display = 'flex';
    }

    function closeEditModal() {
      document.getElementById('editProfileModal').style.display = 'none';
    }

    function saveProfileChanges() {
      const name = document.getElementById('editNameInput').value.trim();
      const email = document.getElementById('editEmailInput').value.trim();
      const avatar = document.getElementById('editAvatarInput').value.trim().toUpperCase() || 'D';
      
      if (name && email) {
        localStorage.setItem('userName', name);
        localStorage.setItem('userEmail', email);
        localStorage.setItem('userAvatar', avatar);
        
        updateAllProfileDisplays();
        closeEditModal();
      } else {
        alert('Please fill in all fields');
      }
    }

    function updateAllProfileDisplays() {
      const name = localStorage.getItem('userName') || 'John Doe';
      const email = localStorage.getItem('userEmail') || 'john.doe@example.com';
      const avatar = localStorage.getItem('userAvatar') || 'D';
      
      document.getElementById('profileName').textContent = name;
      document.getElementById('profileEmail').textContent = email;
      document.getElementById('userAvatar').textContent = avatar;
      document.getElementById('profileAvatarLarge').textContent = avatar;
      
      const composerAvatars = document.querySelectorAll('.composer-avatar');
      composerAvatars.forEach(el => el.textContent = avatar);
    }

    // Load saved profile when page loads
    window.addEventListener('DOMContentLoaded', function() {
      updateAllProfileDisplays();
    });

    // Close modal when clicking outside of it
    window.addEventListener('click', function(event) {
      const modal = document.getElementById('editProfileModal');
      if (event.target === modal) {
        closeEditModal();
      }
    });
  </script>
</body>
</html>